package client;

import java.io.*;
import java.net.*;

import database.*;
import message.*;
import tools.*;

//  此类用于与服务器进行通信，不停地处理消息
public class ChatClient extends Thread {
	private String ServerIP;
	private int port;
	private Socket client;
	private static int OwnIDNum;// 当登陆成功后，为此ChatClient的唯一ID
	private InputStream ins;
	private OutputStream ous;
	
	public ChatClient(String ServerIP, int port) {
		this.ServerIP = ServerIP;
		this.port = port;
	}
	
//	不停地处理消息
	public void run() {
		while (true) {
			try {
				processMsg();
			} catch (IOException e) {
				e.printStackTrace();
				System.out.println("脱离主进程与服务器断开连接");
				JOptionPane.showMessageDialog(null, "与服务器断开连接", "ERROR", JOptionPane.ERROR_MESSAGE);
				System.exit(0);
			}
		}
	}
	
//	连接服务器
	public boolean ConnectServer() {
		try {
			client = new Socket(ServerIP, port);
			System.out.println("服务器已连接");
			ins = client.getInputStream();
			ous = client.getOutputStream();// 获取该连接的输入输出流
			return true;
		} catch (IOException e) {
			// e.printStackTrace();
		}
		return false;
	}
}
